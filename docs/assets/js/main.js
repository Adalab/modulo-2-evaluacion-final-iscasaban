"use strict";const animeTitle=document.querySelector(".js-input"),searchBtn=document.querySelector(".js-btn-search"),animeList=document.querySelector(".js-result"),searchResetBtn=document.querySelector(".js-btn-reset"),favsAnimeList=document.querySelector(".js-favs");let animeFavourites=[];function getAnime(e){e.preventDefault();const t=animeTitle.value;animeList.innerHTML="",fetch("https://api.jikan.moe/v3/search/anime?q="+t).then(e=>e.json()).then(e=>{renderAnime(e.results)})}function renderAnime(e){for(let t=0;t<e.length;t++){const i=e[t],a=renderImg(i.image_url,i.title);-1===animeFavourites.findIndex(e=>parseInt(e.id)===i.mal_id)?animeList.innerHTML+=`<li data-animeid='${i.mal_id}' data-animetitle='${i.title}' data-animeimage='${i.image_url}' class="js-anime-item anime__card"> <img class="anime__card--image" ${a} <h3 class="anime__card--title">${i.title}</h3></li>`:animeList.innerHTML+=`<li data-animeid='${i.mal_id}' data-animetitle='${i.title}' data-animeimage='${i.image_url}' class="js-anime-item anime__card anime__fav--item"> <img class="anime__card--image" ${a} <h3 class="anime__card--title">${i.title}</h3></li>`}const t=document.querySelectorAll(".js-anime-item");for(const e of t)e.addEventListener("click",handleAnimeClick)}const getFromLocalStorage=()=>{const e=localStorage.getItem("animeFavourites");null!==e&&(animeFavourites=JSON.parse(e),renderFavourites())},setInLocalStorage=()=>{const e=JSON.stringify(animeFavourites);localStorage.setItem("animeFavourites",e)};function handleAnimeClick(e){const t=e.currentTarget;t.classList.toggle("anime__fav--item");const i=t.dataset.animeid,a=t.dataset.animetitle,n=t.dataset.animeimage,s={id:i,title:a,image:n},r=animeFavourites.findIndex(e=>e.id===i);-1===r?animeFavourites.push(s):animeFavourites.splice(r,1),setInLocalStorage(),renderFavourites()}function renderFavourites(){favsAnimeList.innerHTML="";for(const e of animeFavourites){const t=renderImg(e.image,e.title);favsAnimeList.innerHTML+=`<li data-animeid='${e.id}' class="js-anime-item anime__card"> <img class="anime__card--image" ${t} <h3 class="anime__card--title">${e.title}</h3></li>`}setInLocalStorage()}function renderImg(e,t){return"https://cdn.myanimelist.net/images/qm_50.gif?s=e1ff92a46db617cb83bfc1e205aff620"!==e&&""!==e&&null!==e||(e="https://via.placeholder.com/225x317.png?text=No+image+available"),`<img src="${e}" alt="${t}" title="${t}" />`}function clearSearch(e){e.preventDefault(),animeList.innerHTML="",animeTitle.value=""}getFromLocalStorage(),renderFavourites(),searchBtn.addEventListener("click",getAnime),searchResetBtn.addEventListener("click",clearSearch);